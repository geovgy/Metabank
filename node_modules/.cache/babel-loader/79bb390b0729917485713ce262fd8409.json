{"ast":null,"code":"import _regeneratorRuntime from\"/Users/mac/writingPlatform/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/mac/writingPlatform/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"/Users/mac/writingPlatform/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/mac/writingPlatform/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import{Container,Row,Col,Card,CardBody,CardTitle,Badge,Button}from\"reactstrap\";import{Link}from\"react-router-dom\";import instance from\"../../../helpers/axiosly\";import stateWrapper from\"../../../containers/provider\";import{withNamespaces}from\"react-i18next\";import Breadcrumbs from\"../../../components/Common/Breadcrumb\";import Pagination from'./Pagination';var Users=function Users(props){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),users=_useState2[0],setUsers=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),orders=_useState4[0],setOrders=_useState4[1];var _useState5=useState({userId:{},orderId:{},loading:false}),_useState6=_slicedToArray(_useState5,2),state=_useState6[0],setState=_useState6[1];var _useState7=useState(1),_useState8=_slicedToArray(_useState7,2),currentPage=_useState8[0],setCurrentPage=_useState8[1];var _useState9=useState(4),_useState10=_slicedToArray(_useState9,2),orderPerPage=_useState10[0],setUsersPerPage=_useState10[1];//get current page\nvar indexOfLastOrder=currentPage*orderPerPage;var indexOffirstOrder=indexOfLastOrder-orderPerPage;var currentOrders=orders.slice(indexOffirstOrder,indexOfLastOrder);//change page\nvar paginate=function paginate(pageNumber){return setCurrentPage(pageNumber);};useEffect(function(){setState(_objectSpread(_objectSpread({},state),{},{loading:true}));function fetchData(){return _fetchData.apply(this,arguments);}function _fetchData(){_fetchData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var token,userRes,orderRes;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;token=localStorage.getItem(\"token\");_context.next=4;return instance.get(\"\".concat(process.env.REACT_APP_DATABASEURL,\"/user\"),{headers:{Authorization:\"Bearer \".concat(token)}});case 4:userRes=_context.sent;setState(_objectSpread(_objectSpread({},state),{},{loading:false}));setUsers(userRes.data.data.rows);_context.next=9;return instance.get(\"\".concat(process.env.REACT_APP_DATABASEURL,\"/order\"),{headers:{Authorization:\"Bearer \".concat(token)}});case 9:orderRes=_context.sent;setOrders(orderRes.data.data.rows);_context.next=16;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 16:case\"end\":return _context.stop();}}},_callee,null,[[0,13]]);}));return _fetchData.apply(this,arguments);}fetchData();//eslint-disable-line\n},[]);var writers=users.filter(function(user){return user.RoleId===3;});var clients=users.filter(function(user){return user.RoleId===2;});var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),search=_useState12[0],setsearch=_useState12[1];function handleSubmit(_x){return _handleSubmit.apply(this,arguments);}function _handleSubmit(){_handleSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(e){var userId,orderId;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:e.preventDefault();try{userId=Object.keys(state.userId).filter(function(i){var _state$userId$;return((_state$userId$=state.userId[\"\".concat(i)])===null||_state$userId$===void 0?void 0:_state$userId$.status)==true;})[0];orderId=Object.keys(state.orderId).filter(function(i){var _state$orderId$2;return((_state$orderId$2=state.orderId[\"\".concat(i)])===null||_state$orderId$2===void 0?void 0:_state$orderId$2.status)==true;});orderId.forEach(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(i){var _state$userId$userId,_state$userId$userId$,_state$orderId$i,_state$orderId$i$valu;var body,token;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:console.log(i);body={user_id:(_state$userId$userId=state.userId[userId])===null||_state$userId$userId===void 0?void 0:(_state$userId$userId$=_state$userId$userId.value)===null||_state$userId$userId$===void 0?void 0:_state$userId$userId$.id,order_id:(_state$orderId$i=state.orderId[i])===null||_state$orderId$i===void 0?void 0:(_state$orderId$i$valu=_state$orderId$i.value)===null||_state$orderId$i$valu===void 0?void 0:_state$orderId$i$valu.id};console.log(body);token=localStorage.getItem(\"token\");_context2.next=6;return instance.post(\"\".concat(process.env.REACT_APP_DATABASEURL,\"/project\"),_objectSpread({},body),{headers:{Authorization:\"Bearer \".concat(token)}}).then(function(response){console.log(response.data.data);}).catch(function(e){return console.log(e);});case 6:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref.apply(this,arguments);};}());}catch(e){console.log(e);}case 2:case\"end\":return _context3.stop();}}},_callee3);}));return _handleSubmit.apply(this,arguments);}var handleInputChangeForUser=function handleInputChangeForUser(key,value){var temp=Object.keys(state.userId).map(function(i){var t={};t[\"\".concat(i)]={status:false,value:value};return t;});temp[key]={status:true,value:value};setState(_objectSpread(_objectSpread({},state),{},{userId:temp}));};var handleInputChangeForOrder=function handleInputChangeForOrder(key,value){var _state$orderId$$statu,_state$orderId$;console.log(value);var temp=Object.keys(state.orderId).map(function(i){return state.orderId[\"\".concat(i)];});temp[key]={status:(_state$orderId$$statu=!((_state$orderId$=state.orderId[\"\".concat(key)])===null||_state$orderId$===void 0?void 0:_state$orderId$.status))!==null&&_state$orderId$$statu!==void 0?_state$orderId$$statu:false,value:value};setState(_objectSpread(_objectSpread({},state),{},{orderId:temp}));};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"page-content\"},/*#__PURE__*/React.createElement(Container,{fluid:true},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{lg:\"12\"},/*#__PURE__*/React.createElement(Breadcrumbs,{title:props.t(\"Project\"),breadcrumbItem:props.t(\"Assign Project\")}),/*#__PURE__*/React.createElement(Card,null,/*#__PURE__*/React.createElement(CardBody,null,state.loading?/*#__PURE__*/React.createElement(\"div\",{class:\"spinner-border\",role:\"status\"},/*#__PURE__*/React.createElement(\"span\",{class:\"sr-only\"},\"Loading...\")):/*#__PURE__*/React.createElement(\"form\",{onSubmit:handleSubmit},/*#__PURE__*/React.createElement(\"div\",{className:\"p-0\",\"aria-labelledby\":\"page-header-search-dropdown\"},/*#__PURE__*/React.createElement(\"form\",{className:\"p-3\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group m-0\"},/*#__PURE__*/React.createElement(\"div\",{className:\"input-group\"},/*#__PURE__*/React.createElement(\"input\",{type:\"text\",className:\"form-control\",placeholder:\"Search...\",\"aria-label\":\"Recipient's username\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"input-group-append\"},/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-primary\",type:\"submit\"},/*#__PURE__*/React.createElement(\"i\",{className:\"mdi mdi-magnify\"}))))))),/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"table-responsive col\"},/*#__PURE__*/React.createElement(\"table\",{className:\"table\"},/*#__PURE__*/React.createElement(\"thead\",{className:\"thead-light\"},/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"th\",{style:{width:\"20px\"}},\" \"),/*#__PURE__*/React.createElement(\"th\",null,\"Writer\"))),/*#__PURE__*/React.createElement(\"tbody\",null,writers.map(function(writer,key){var _state$userId$key;return/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"custom-control custom-checkbox\"},/*#__PURE__*/React.createElement(\"input\",{type:\"checkbox\",className:\"custom-control-input\",id:writer.id,checked:(state===null||state===void 0?void 0:(_state$userId$key=state.userId[key])===null||_state$userId$key===void 0?void 0:_state$userId$key.status)==true?true:false,onChange:function onChange(e){handleInputChangeForUser(key,writer);},key:key}),/*#__PURE__*/React.createElement(\"label\",{className:\"custom-control-label\",htmlFor:writer.id},\"\\xA0\"))),/*#__PURE__*/React.createElement(\"td\",null,writer.first_name,\" \",writer.last_name));})))),/*#__PURE__*/React.createElement(\"div\",{className:\"table-responsive col\"},/*#__PURE__*/React.createElement(\"table\",{className:\"table\"},/*#__PURE__*/React.createElement(\"thead\",{className:\"thead-light\"},/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"th\",null,\"Client\"))),/*#__PURE__*/React.createElement(\"tbody\",null,clients.map(function(client,key){return/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",null,client.first_name,\" \",client.last_name));})))),/*#__PURE__*/React.createElement(\"div\",{className:\"col\"},/*#__PURE__*/React.createElement(\"table\",{className:\"table\"},/*#__PURE__*/React.createElement(\"thead\",{className:\"thead-light\"},/*#__PURE__*/React.createElement(\"tr\",{className:\"table-primary\",onClick:function onClick(){setsearch(!search);}},/*#__PURE__*/React.createElement(\"th\",{style:{width:\"20px\"}},\" \"),/*#__PURE__*/React.createElement(\"th\",null,\"Orders\"))),/*#__PURE__*/React.createElement(\"tbody\",null,currentOrders.map(function(order,key){var _state$orderId$key;return/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"custom-control custom-checkbox\"},/*#__PURE__*/React.createElement(\"input\",{type:\"checkbox\",className:\"custom-control-input\",id:order.id,checked:(state===null||state===void 0?void 0:(_state$orderId$key=state.orderId[key])===null||_state$orderId$key===void 0?void 0:_state$orderId$key.status)==true?true:false,onChange:function onChange(){return handleInputChangeForOrder(key,order);}}),/*#__PURE__*/React.createElement(\"label\",{className:\"custom-control-label\",htmlFor:order.id},\"\\xA0\"))),/*#__PURE__*/React.createElement(\"td\",null,order.topic));}))),/*#__PURE__*/React.createElement(Pagination,{orderPerPage:orderPerPage,totalOrder:orders.length,paginate:paginate})),/*#__PURE__*/React.createElement(\"div\",{className:\"col\"},/*#__PURE__*/React.createElement(Button,{type:\"submit\",color:\"primary\",className:\"btn btn-primary waves-effect waves-light\"},\" \",\"Assign Project\")))))))))));};export default withNamespaces()(stateWrapper(Users));","map":{"version":3,"sources":["/Users/mac/writingPlatform/src/pages/SuperAdmin/Project/AssignProject.js"],"names":["React","useEffect","useState","Container","Row","Col","Card","CardBody","CardTitle","Badge","Button","Link","instance","stateWrapper","withNamespaces","Breadcrumbs","Pagination","Users","props","users","setUsers","orders","setOrders","userId","orderId","loading","state","setState","currentPage","setCurrentPage","orderPerPage","setUsersPerPage","indexOfLastOrder","indexOffirstOrder","currentOrders","slice","paginate","pageNumber","fetchData","token","localStorage","getItem","get","process","env","REACT_APP_DATABASEURL","headers","Authorization","userRes","data","rows","orderRes","console","log","writers","filter","user","RoleId","clients","search","setsearch","handleSubmit","e","preventDefault","Object","keys","i","status","forEach","body","user_id","value","id","order_id","post","then","response","catch","handleInputChangeForUser","key","temp","map","t","handleInputChangeForOrder","width","writer","first_name","last_name","client","order","topic","length"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport {  Container, Row, Col, Card, CardBody, CardTitle, Badge, Button } from \"reactstrap\";\nimport { Link } from \"react-router-dom\";\nimport instance from \"../../../helpers/axiosly\";\nimport stateWrapper from \"../../../containers/provider\";\nimport { withNamespaces } from \"react-i18next\";\nimport Breadcrumbs from \"../../../components/Common/Breadcrumb\";\nimport Pagination from './Pagination'\n\nconst Users = (props) => {\n \n  const[users, setUsers] = useState([]);\n  const[orders, setOrders] = useState([])\n\n  const [state, setState] = useState({\n    userId: {},\n    orderId: {},\n    loading: false\n  })\n  const[currentPage, setCurrentPage] = useState(1);\n  const [orderPerPage, setUsersPerPage] = useState(4)\n\n  //get current page\n  const indexOfLastOrder = currentPage * orderPerPage;\n  const indexOffirstOrder = indexOfLastOrder - orderPerPage;\n  const currentOrders = orders.slice(indexOffirstOrder, indexOfLastOrder);\n  //change page\n  const paginate = (pageNumber) => setCurrentPage(pageNumber)\n\n  useEffect(() => {\n    setState({...state, loading: true})\n    async function fetchData(){ \n    try {\n      const token = localStorage.getItem(\"token\")\n      const userRes = await instance\n        .get(`${process.env.REACT_APP_DATABASEURL}/user`, {\n          headers: {\n            Authorization: `Bearer ${token}`,\n          },\n        })\n        setState({...state, loading: false})\n        setUsers(userRes.data.data.rows)\n\n        const orderRes = await instance\n        .get(`${process.env.REACT_APP_DATABASEURL}/order`, {\n          headers: {\n            Authorization: `Bearer ${token}`,\n          },\n        })\n        \n        setOrders(orderRes.data.data.rows)\n       \n    } catch (e) {\n      console.log(e);\n    } \n    }\n    fetchData();\n    //eslint-disable-line\n  }, [])\n  \n  const writers = users.filter(user => user.RoleId === 3)\n  const clients = users.filter(user => user.RoleId === 2)\n\n\n  const [search, setsearch] = useState(false);\n\n  async function handleSubmit(e) {\n    e.preventDefault();\n    \n      try {\n        const userId = Object.keys(state.userId).filter(i => state.userId[`${i}`]?.status == true )[0];\n        const orderId = Object.keys(state.orderId).filter(i => state.orderId[`${i}`]?.status == true);\n\n        orderId.forEach(async i => {\n          console.log(i);\n          const body = {\n            user_id: state.userId[userId]?.value?.id,\n            order_id: state.orderId[i]?.value?.id\n          }\n          console.log(body);\n          const token = localStorage.getItem(\"token\")\n          await instance\n              .post(`${process.env.REACT_APP_DATABASEURL}/project`,  {...body}, {\n                headers: {\n                  Authorization: `Bearer ${token}`,\n                },\n              }).then((response) => {\n                  console.log(response.data.data)})\n                  .catch((e) => console.log(e));\n        });    \n      }\n       catch (e) {\n        console.log(e);\n      }\n  }\n\n  const handleInputChangeForUser = (key, value) => {\n    const temp = Object.keys(state.userId).map(i => {\n      let t = {};\n      t[`${i}`] = { status: false, value }\n      return t;\n    });\n    temp[key] = {status: true, value};\n    setState({...state, userId: temp});\n  }\n\n  const handleInputChangeForOrder = (key, value) => {\n    console.log(value);\n    const temp = Object.keys(state.orderId).map(i => {\n      return state.orderId[`${i}`];\n    });\n    temp[key] = {status: !state.orderId[`${key}`]?.status ?? false, value};\n    setState({...state, orderId: temp});\n  }\n\n  return (\n    <React.Fragment>\n        <div className=\"page-content\">\n        <Container fluid>\n        <Row>\n        <Col lg=\"12\">\n         {/* Render Breadcrumb */}\n         <Breadcrumbs\n            title={props.t(\"Project\")}\n            breadcrumbItem={props.t(\"Assign Project\")}\n          />\n      <Card>\n        <CardBody>\n          {state.loading ? (<div class=\"spinner-border\" role=\"status\">\n                  <span class=\"sr-only\">Loading...</span>\n                  </div>):(\n                       <form onSubmit={handleSubmit}>\n                       <div className=\"p-0\"\n                               aria-labelledby=\"page-header-search-dropdown\">\n                               <form className=\"p-3\">\n                                 <div className=\"form-group m-0\">\n                                   <div className=\"input-group\">\n                                     <input type=\"text\" className=\"form-control\" placeholder=\"Search...\" aria-label=\"Recipient's username\" />\n                                     <div className=\"input-group-append\">\n                                       <button className=\"btn btn-primary\" type=\"submit\"><i className=\"mdi mdi-magnify\"></i></button>\n                                     </div>\n                                   </div>\n                                 </div>\n                               </form>\n                             </div>\n                       <div className=\"row\">\n                       <div className=\"table-responsive col\">\n                         <table className=\"table\">\n                           <thead className=\"thead-light\">\n                             <tr>\n                               <th style={{ width: \"20px\" }}>\n                                 {\" \"}\n                               </th>\n                               <th>Writer</th>\n                             </tr>\n                           </thead>\n                           <tbody>\n                             {writers.map((writer, key) => (\n                               <tr>\n                                 <td>\n                                   <div className=\"custom-control custom-checkbox\">\n                                     <input\n                                       type=\"checkbox\"\n                                       className=\"custom-control-input\"\n                                       id={writer.id}\n                                       checked={state?.userId[key]?.status == true ? true : false}\n                                       onChange={e => {\n                                         handleInputChangeForUser(key, writer);\n                                       }}\n                                       key={key}\n                                     />\n                                     <label\n                                       className=\"custom-control-label\"\n                                       htmlFor={writer.id}\n                                     >\n                                       &nbsp;\n                                     </label>\n                                   </div>\n                                 </td>\n                                 <td>{writer.first_name} {writer.last_name}</td>      \n                               </tr>\n                             ))}\n                             \n                           </tbody>\n                         </table>\n                       </div>\n                      <div className=\"table-responsive col\">\n                      <table className=\"table\">\n                           <thead className=\"thead-light\">\n                             <tr>\n                               <th>Client</th>\n                             </tr>\n                           </thead>\n                           <tbody>\n                             {clients.map((client, key) => (\n                               <tr>\n                                 <td>{client.first_name} {client.last_name}</td>       \n                               </tr>\n                             ))}\n                             \n                           </tbody>\n                         </table>\n                      </div>\n                      <div className=\"col\">\n                      <table className=\"table\">\n                           <thead className=\"thead-light\">\n                             <tr className=\"table-primary\" onClick={() => { setsearch(!search) }}>\n                               <th style={{ width: \"20px\" }}>\n                                 {\" \"}\n                               </th>\n                               <th>\n                                     Orders\n                               </th>\n                             </tr>\n                           </thead>\n                           <tbody>\n                               {currentOrders.map((order, key) => ( \n                               <tr>\n                                 <td>\n                                   <div className=\"custom-control custom-checkbox\">\n                                     <input\n                                       type=\"checkbox\"\n                                       className=\"custom-control-input\"\n                                       id={order.id}\n                                       checked={state?.orderId[key]?.status == true ? true : false}\n                                        onChange={() => handleInputChangeForOrder(key, order)}\n                                      />\n                                     <label\n                                       className=\"custom-control-label\"\n                                       htmlFor={order.id}\n                                     >\n                                       &nbsp;\n                                     </label>\n                                   </div>\n                                 </td>\n                                 <td>{order.topic}</td>        \n                               </tr>  \n                                  ))}                          \n                           </tbody>\n                           \n                         </table>\n                         <Pagination orderPerPage={orderPerPage} totalOrder={orders.length} paginate={paginate}/> \n                      </div>\n                      <div className=\"col\"> \n                                 <Button\n                                 type=\"submit\"\n                                 color=\"primary\"\n                                 className=\"btn btn-primary waves-effect waves-light\"\n                                   >\n                                   {\" \"}\n                                  Assign Project\n                                 </Button>\n             \n                      </div>\n                      </div>\n                        \n                       \n                     \n                       </form>\n                  )}\n         \n\n        </CardBody>\n        </Card>\n        </Col>\n        </Row>\n    </Container>\n            </div>\n    </React.Fragment>\n  );\n};\n\nexport default withNamespaces()(stateWrapper(Users));"]},"metadata":{},"sourceType":"module"}