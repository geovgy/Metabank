{"ast":null,"code":"import _regeneratorRuntime from\"/Users/mac/writingPlatform/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/mac/writingPlatform/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"/Users/mac/writingPlatform/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/mac/writingPlatform/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/mac/writingPlatform/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{Container,Row,Col,Button,Card,CardBody,CardTitle,Modal,ModalHeader,ModalBody,ModalFooter,Media,Table,NavItem,NavLink,TabContent,TabPane,FormGroup,Label,Input}from\"reactstrap\";import classnames from\"classnames\";import{Link}from\"react-router-dom\";//Import Breadcrumb\nimport Breadcrumbs from\"../../../components/Common/Breadcrumb\";//i18n\nimport{withNamespaces}from\"react-i18next\";import AvForm from\"availity-reactstrap-validation/lib/AvForm\";import Dropzone from\"react-dropzone\";import stateWrapper from\"../../../containers/provider\";import instance from\"../../../helpers/axiosly\";var Library=function Library(props){var _useState=useState(1),_useState2=_slicedToArray(_useState,2),activeTab=_useState2[0],setactiveTab=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),selectedFiles=_useState4[0],setselectedFiles=_useState4[1];var _useState5=useState({title:\"\",description:\"\",additionMaterial:\"\",loading:false,droploading:false}),_useState6=_slicedToArray(_useState5,2),state=_useState6[0],setState=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),updateLibrary=_useState8[0],setUpdateLibrary=_useState8[1];useEffect(function(){var libraryData,userData;userData=props.userStore.fetchUser(props);libraryData=props.masterStore.fetchLibrary(userData.access_token);if(props.match.params.id){setUpdateLibrary(\"update\");setState(_objectSpread(_objectSpread({},state),{},{title:currentLibrary.map(function(e){return e.title;}),description:currentLibrary.map(function(e){return e.description;})}));setselectedFiles(currentLibrary.map(function(e){return e.url;}));}else{setState(_objectSpread(_objectSpread({},state),{},{title:'',description:''}));setselectedFiles([]);}//eslint-disable-line\n},[]);var libraries=props.masterStore.state.sessionData.libraryList;var currentLibrary=libraries&&libraries.filter(function(e){return e.id===Number(props.match.params.id);});var onChange=function onChange(e){var _e$target=e.target,name=_e$target.name,value=_e$target.value;setState(_objectSpread(_objectSpread({},state),{},_defineProperty({},name,value)));};function formatBytes(bytes){var decimals=arguments.length>1&&arguments[1]!==undefined?arguments[1]:2;if(bytes===0)return\"0 Bytes\";var k=1024;var dm=decimals<0?0:decimals;var sizes=[\"Bytes\",\"KB\",\"MB\",\"GB\",\"TB\",\"PB\",\"EB\",\"ZB\",\"YB\"];var i=Math.floor(Math.log(bytes)/Math.log(k));return parseFloat((bytes/Math.pow(k,i)).toFixed(dm))+\" \"+sizes[i];}function handleAcceptedFiles(files){setState({droploading:true});files.map(function(file){return Object.assign(file,{preview:URL.createObjectURL(file),formattedSize:formatBytes(file.size)});});setselectedFiles(files);setTimeout(function(){setState(_objectSpread(_objectSpread({},state),{},{droploading:false}));},1000);}function handleValidSubmit(_x){return _handleValidSubmit.apply(this,arguments);}function _handleValidSubmit(){_handleValidSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var userData;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setState(_objectSpread(_objectSpread({},state),{},{loading:true}));userData=props.userStore.fetchUser(props);e.preventDefault();props.masterStore.addLibrary(state,userData.access_token,selectedFiles[0]);setTimeout(function(){setState(_objectSpread(_objectSpread({},state),{},{title:\"\",description:\"\",loading:false}));},2000);setselectedFiles([]);setTimeout(function(){props.history.push({pathname:\"/library\",state:{status:'created'}});},2000);case 7:case\"end\":return _context.stop();}}},_callee);}));return _handleValidSubmit.apply(this,arguments);}var handleUpdate=function handleUpdate(e){setState(_objectSpread(_objectSpread({},state),{},{loading:true}));var userData;userData=props.userStore.fetchUser(props);e.preventDefault();var id=Number(props.match.params.id);props.masterStore.updateLibrary(state,userData.access_token,selectedFiles[0],id);setTimeout(function(){setState(_objectSpread(_objectSpread({},state),{},{title:\"\",description:\"\",loading:false}));},2000);setselectedFiles([]);setTimeout(function(){props.history.push({pathname:\"/library\",state:{status:'updated'}});},2000);};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"page-content\"},/*#__PURE__*/React.createElement(Container,{fluid:true},/*#__PURE__*/React.createElement(Breadcrumbs,{title:props.t(\"Library\"),breadcrumbItem:props.t(\"Library\")}),/*#__PURE__*/React.createElement(AvForm,{className:\"form-horizontal\",onValidSubmit:function onValidSubmit(e,v){handleValidSubmit(e,v);}},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{lg:\"12\"},/*#__PURE__*/React.createElement(Card,null,/*#__PURE__*/React.createElement(CardBody,null,/*#__PURE__*/React.createElement(\"div\",{id:\"basic-pills-wizard\",className:\"twitter-bs-wizard\"},/*#__PURE__*/React.createElement(\"ul\",{className:\"twitter-bs-wizard-nav nav nav-justified nav-pills\"},/*#__PURE__*/React.createElement(NavItem,null,/*#__PURE__*/React.createElement(NavLink,{className:classnames({active:activeTab===1}),onClick:function onClick(){setactiveTab(1);}},/*#__PURE__*/React.createElement(\"span\",{className:\"step-number mr-2\"},\"01\"),\"Library Details\"))),/*#__PURE__*/React.createElement(TabContent,{activeTab:activeTab,className:\"twitter-bs-wizard-tab-content\"},/*#__PURE__*/React.createElement(TabPane,{tabId:1},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{lg:\"12\"},/*#__PURE__*/React.createElement(FormGroup,null,/*#__PURE__*/React.createElement(Label,{for:\"basicpill-firstname-input14\"},\"library Title\"),/*#__PURE__*/React.createElement(Input,{value:state.title,onChange:onChange,name:\"title\",type:\"text\",id:\"basicpill-firstname-input14\",className:\"form-control\"})))),/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{lg:\"6\"},/*#__PURE__*/React.createElement(FormGroup,null,/*#__PURE__*/React.createElement(Label,{for:\"basicpill-address-input2\"},\"DESCRIPTION\"),/*#__PURE__*/React.createElement(\"textarea\",{value:state.description,onChange:onChange,name:\"description\",id:\"basicpill-address-input2\",className:\"form-control\",rows:\"11\"}))),/*#__PURE__*/React.createElement(Col,{lg:\"6\"},/*#__PURE__*/React.createElement(Label,{for:\"basicpill-address-input2\"},\"ADDITION MATERIAL\"),/*#__PURE__*/React.createElement(Dropzone,{onDrop:function onDrop(acceptedFiles){handleAcceptedFiles(acceptedFiles);}},function(_ref){var getRootProps=_ref.getRootProps,getInputProps=_ref.getInputProps;return/*#__PURE__*/React.createElement(\"div\",{className:\"dropzone\"},/*#__PURE__*/React.createElement(\"div\",Object.assign({className:\"dz-message needclick mt-2\"},getRootProps()),/*#__PURE__*/React.createElement(\"input\",getInputProps()),/*#__PURE__*/React.createElement(\"div\",{className:\"mb-3\"},/*#__PURE__*/React.createElement(\"i\",{className:\"display-4 text-muted bx bxs-cloud-upload\"})),/*#__PURE__*/React.createElement(\"h5\",null,\"Drop files here or click to upload.\")));}),/*#__PURE__*/React.createElement(\"div\",{className:\"dropzone-previews mt-3\",id:\"file-previews\"},state.droploading?/*#__PURE__*/React.createElement(\"div\",{class:\"spinner-border\",role:\"status\"},/*#__PURE__*/React.createElement(\"span\",{class:\"sr-only\"},\"Loading...\")):selectedFiles.map(function(f,i){return/*#__PURE__*/React.createElement(Card,{key:i+\"-file\",className:\"mt-1 mb-0 shadow-none border dz-processing dz-image-preview dz-success dz-complete\"},/*#__PURE__*/React.createElement(\"div\",{className:\"p-2\"},/*#__PURE__*/React.createElement(Row,{className:\"align-items-center\"},/*#__PURE__*/React.createElement(Col,{className:\"col-auto\"},/*#__PURE__*/React.createElement(\"img\",{\"data-dz-thumbnail\":\"\",height:\"80\",className:\"avatar-sm rounded bg-light\",alt:f.name,src:f.preview})),/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Link,{to:\"#\",className:\"text-muted font-weight-bold\"},f.name),/*#__PURE__*/React.createElement(\"p\",{className:\"mb-0\"},/*#__PURE__*/React.createElement(\"strong\",null,f.formattedSize))))));}))))))),updateLibrary===\"\"?/*#__PURE__*/React.createElement(\"div\",null,state.loading?/*#__PURE__*/React.createElement(\"div\",{className:\"spinner-grow text-primary m-1\",role:\"status\"}):/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",className:\"btn btn-warning waves-effect waves-light\"},\"Submit\")):/*#__PURE__*/React.createElement(\"div\",null,state.loading?/*#__PURE__*/React.createElement(\"div\",{className:\"spinner-grow text-primary m-1\",role:\"status\"}):/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",className:\"btn btn-warning waves-effect waves-light\",onClick:handleUpdate},\"Update\"))))))))));};export default withNamespaces()(stateWrapper(Library));","map":{"version":3,"sources":["/Users/mac/writingPlatform/src/pages/SuperAdmin/library/Createlibrary.js"],"names":["React","useState","useEffect","Container","Row","Col","Button","Card","CardBody","CardTitle","Modal","ModalHeader","ModalBody","ModalFooter","Media","Table","NavItem","NavLink","TabContent","TabPane","FormGroup","Label","Input","classnames","Link","Breadcrumbs","withNamespaces","AvForm","Dropzone","stateWrapper","instance","Library","props","activeTab","setactiveTab","selectedFiles","setselectedFiles","title","description","additionMaterial","loading","droploading","state","setState","updateLibrary","setUpdateLibrary","libraryData","userData","userStore","fetchUser","masterStore","fetchLibrary","access_token","match","params","id","currentLibrary","map","e","url","libraries","sessionData","libraryList","filter","Number","onChange","target","name","value","formatBytes","bytes","decimals","k","dm","sizes","i","Math","floor","log","parseFloat","pow","toFixed","handleAcceptedFiles","files","file","Object","assign","preview","URL","createObjectURL","formattedSize","size","setTimeout","handleValidSubmit","preventDefault","addLibrary","history","push","pathname","status","handleUpdate","t","v","active","acceptedFiles","getRootProps","getInputProps","f"],"mappings":"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","sourcesContent":["import React, { useState, useEffect  } from \"react\";\nimport {\n  Container,\n  Row,\n  Col,\n  Button,\n  Card,\n  CardBody,\n  CardTitle,\n  Modal,\n  ModalHeader,\n  ModalBody,\n  ModalFooter,\n  Media,\n  Table,\n  NavItem,\n  NavLink,\n  TabContent,\n  TabPane,\n  FormGroup,\n  Label,\n  Input,\n} from \"reactstrap\";\nimport classnames from \"classnames\";\nimport { Link } from \"react-router-dom\";\n//Import Breadcrumb\nimport Breadcrumbs from \"../../../components/Common/Breadcrumb\";\n\n//i18n\nimport { withNamespaces } from \"react-i18next\";\nimport AvForm from \"availity-reactstrap-validation/lib/AvForm\";\nimport Dropzone from \"react-dropzone\";\n\nimport stateWrapper from \"../../../containers/provider\";\n\nimport instance from \"../../../helpers/axiosly\";\n\nconst Library = (props) => {\n\n  const[activeTab, setactiveTab] = useState(1)\n  const [selectedFiles, setselectedFiles] = useState([]);\n\n  const [state, setState] = useState({\n    title: \"\",\n    description: \"\",\n    additionMaterial: \"\",\n    loading: false,\n    droploading: false\n  })\n\n  const[updateLibrary, setUpdateLibrary] = useState(\"\");\n\n  useEffect(() => {\n\n    let libraryData, userData;\n    userData = props.userStore.fetchUser(props);\n\n    libraryData = props.masterStore.fetchLibrary(\n      userData.access_token\n    );\n\n    if(props.match.params.id){\n      setUpdateLibrary(\"update\")\n        setState({\n        ...state,\n        title: currentLibrary.map(e => {return (e.title)}),\n        description: currentLibrary.map(e => {return (e.description)})\n        })\n        setselectedFiles(currentLibrary.map(e => {return (e.url)}))\n    } else {\n        setState({\n        ...state,\n        title: '',\n        description: ''\n      })\n      setselectedFiles([])\n      }\n\n    //eslint-disable-line\n  }, [])\n\n  let libraries = props.masterStore.state.sessionData.libraryList;\n\n  let currentLibrary = libraries && libraries.filter((e) => e.id === Number(props.match.params.id))\n\n\n  const onChange = (e) => {\n    let { name, value } = e.target;\n    setState({\n      ...state,\n      [name]: value,\n    });\n  }\n\n  function formatBytes(bytes, decimals = 2) {\n    if (bytes === 0) return \"0 Bytes\";\n    const k = 1024;\n    const dm = decimals < 0 ? 0 : decimals;\n    const sizes = [\"Bytes\", \"KB\", \"MB\", \"GB\", \"TB\", \"PB\", \"EB\", \"ZB\", \"YB\"];\n\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + \" \" + sizes[i];\n  }\n\n  function handleAcceptedFiles(files) {\n    setState({\n      droploading: true,\n    });\n    files.map((file) =>\n      Object.assign(file, {\n        preview: URL.createObjectURL(file),\n        formattedSize: formatBytes(file.size),\n      })\n    );\n    setselectedFiles(files);\n    setTimeout(function(){\n      setState({...state, droploading: false})\n    }, 1000)\n\n  }\n\n  async function handleValidSubmit(e) {\n    setState({...state,\n      loading: true,\n    });\n    let  userData;\n    userData = props.userStore.fetchUser(props);\n    e.preventDefault()\n    props.masterStore.addLibrary(state, userData.access_token, selectedFiles[0])\n\n    setTimeout(function(){\n      setState({...state,\n        title: \"\",\n        description: \"\",\n        loading: false\n      })\n    }, 2000)\n\n    setselectedFiles([])\n\n    setTimeout(function(){\n     props.history.push({pathname:\"/library\", state:{status: 'created'}});\n    }, 2000)\n\n  }\n\n  const handleUpdate = (e) => {\n    setState({...state,\n      loading: true,\n    });\n    let  userData;\n    userData = props.userStore.fetchUser(props);\n\n\n\n    e.preventDefault()\n    let id = Number(props.match.params.id)\n\n    props.masterStore.updateLibrary(state, userData.access_token, selectedFiles[0], id)\n\n    setTimeout(function(){\n      setState({...state,\n        title: \"\",\n        description: \"\",\n        loading: false\n      })\n    }, 2000)\n    setselectedFiles([])\n\n    setTimeout(function(){\n     props.history.push({pathname:\"/library\", state:{status: 'updated'}});\n    }, 2000)\n\n  }\n\n  return (\n    <React.Fragment>\n      <div className=\"page-content\">\n        <Container fluid>\n          {/* Render Breadcrumb */}\n          <Breadcrumbs\n            title={props.t(\"Library\")}\n            breadcrumbItem={props.t(\"Library\")}\n          />\n           <AvForm\n           className=\"form-horizontal\"\n           onValidSubmit={(e, v) => {\n             handleValidSubmit(e, v);\n           }}\n           >\n            <Row>\n              <Col lg=\"12\">\n                <Card>\n                  <CardBody>\n\n\n                  <div id=\"basic-pills-wizard\" className=\"twitter-bs-wizard\">\n                  <ul className=\"twitter-bs-wizard-nav nav nav-justified nav-pills\">\n                    <NavItem>\n                      <NavLink\n                        className={classnames({active: activeTab === 1})}\n                        onClick={() => {\n                          setactiveTab(1)\n                        }}\n                      >\n                        <span className=\"step-number mr-2\">01</span>\n                        Library Details\n                      </NavLink>\n                    </NavItem>\n                  </ul>\n                  <TabContent\n                    activeTab={activeTab}\n                    className=\"twitter-bs-wizard-tab-content\"\n                  >\n                    <TabPane tabId={1}>\n                     <Row>\n                      <Col lg=\"12\">\n                        <FormGroup>\n                          <Label for=\"basicpill-firstname-input14\">\n                            library Title\n                          </Label>\n                          <Input\n                             value={state.title}\n                             onChange={onChange}\n                             name=\"title\"\n                            type=\"text\"\n                            id=\"basicpill-firstname-input14\"\n                            className=\"form-control\"\n                          />\n                        </FormGroup>\n                      </Col>\n                      </Row>\n                      <Row>\n                        <Col lg=\"6\">\n                        <FormGroup>\n                            <Label for=\"basicpill-address-input2\">\n                              DESCRIPTION\n                            </Label>\n                            <textarea\n                               value={state.description}\n                               onChange={onChange}\n                              name=\"description\"\n                              id=\"basicpill-address-input2\"\n                              className=\"form-control\"\n                              rows=\"11\"\n                            ></textarea>\n                          </FormGroup>\n                        </Col>\n                        <Col lg=\"6\">\n                        <Label for=\"basicpill-address-input2\">\n                              ADDITION MATERIAL\n                            </Label>\n                            <Dropzone\n                              onDrop={(acceptedFiles) => {\n                                handleAcceptedFiles(acceptedFiles);\n                              }}\n                            >\n                              {({getRootProps, getInputProps}) => (\n                                  <div className=\"dropzone\">\n                                  <div className=\"dz-message needclick mt-2\" {...getRootProps()}>\n                                    <input {...getInputProps()}/>\n                                    <div className=\"mb-3\">\n                                    <i className=\"display-4 text-muted bx bxs-cloud-upload\"></i>\n                                    </div>\n                                    <h5>\n                                        Drop files here or click to upload.\n                                      </h5>\n                                  </div>\n                                </div>\n                              )}\n\n                            </Dropzone>\n                            <div className=\"dropzone-previews mt-3\" id=\"file-previews\">\n                                {state.droploading ? (<div class=\"spinner-border\" role=\"status\">\n                                    <span class=\"sr-only\">Loading...</span>\n                                    </div>) :  selectedFiles.map((f, i) => {\n                                  return (\n                                    <Card key={i + \"-file\"} className=\"mt-1 mb-0 shadow-none border dz-processing dz-image-preview dz-success dz-complete\">\n                                       <div className=\"p-2\">\n                                        <Row className=\"align-items-center\">\n                                          <Col className=\"col-auto\">\n                                            <img\n                                              data-dz-thumbnail=\"\"\n                                              height=\"80\"\n                                              className=\"avatar-sm rounded bg-light\"\n                                              alt={f.name}\n                                              src={f.preview}\n                                            />\n                                          </Col>\n                                          <Col>\n                                            <Link\n                                              to=\"#\"\n                                              className=\"text-muted font-weight-bold\"\n                                            >\n                                              {f.name}\n                                            </Link>\n                                            <p className=\"mb-0\">\n                                              <strong>{f.formattedSize}</strong>\n                                            </p>\n                                          </Col>\n                                        </Row>\n                                      </div>\n\n                                    </Card>\n                                  )\n                                })}\n                            </div>\n                        </Col>\n                      </Row>\n                    </TabPane>\n                  </TabContent>\n                  </div>\n                  {updateLibrary  === \"\" ?\n                    (\n                      <div>\n                        {state.loading ? (\n                           <div\n                           className=\"spinner-grow text-primary m-1\"\n                           role=\"status\"\n                         >\n                           {/* <span className=\"sr-only\">Loading...</span> */}\n                         </div>\n                         ): (\n                          <button\n                         type=\"submit\"\n                          className=\"btn btn-warning waves-effect waves-light\"\n                        >\n                          Submit\n                        </button>\n                         )}\n\n                      </div>\n\n                    ): (\n                      <div>\n                        {state.loading ? (\n                           <div\n                           className=\"spinner-grow text-primary m-1\"\n                           role=\"status\"\n                         >\n                           {/* <span className=\"sr-only\">Loading...</span> */}\n                         </div>\n                         ): (\n                          <button\n                          type=\"submit\"\n                          className=\"btn btn-warning waves-effect waves-light\"\n                          onClick={handleUpdate}\n                        >\n                          Update\n                        </button>\n                         )}\n\n                    </div>\n                    )\n                  }\n\n                  </CardBody>\n                </Card>\n              </Col>\n            </Row>\n          </AvForm>\n          </Container>\n          </div>\n    </React.Fragment>\n  );\n};\n\nexport default withNamespaces()(stateWrapper(Library));\n"]},"metadata":{},"sourceType":"module"}